<!DOCTYPE html>
<html lang="chinese (simplified)">
<head>
    <meta charset="utf-8">
	<link rel="blog icon" href="https://ouyonghao.github.io/favicon.ico"/>
	<link rel="bookmark"  href="https://ouyonghao.github.io/favicon.ico"/>
    <title>碎琼乱玉 - My test</title>
    <meta name="description" content="">
    <meta name="author" content="oyh">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://ouyonghao.github.io/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="https://ouyonghao.github.io/theme/bootstrap.min.css" rel="stylesheet">
    <link href="https://ouyonghao.github.io/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="https://ouyonghao.github.io/theme/local.css" rel="stylesheet">
    <link href="https://ouyonghao.github.io/theme/pygments.css" rel="stylesheet">

    <!-- So Firefox can bookmark->"abo this site" -->

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="https://ouyonghao.github.io">碎琼乱玉</a>

        <div class="nav-collapse">
        <ul class="nav">
            <li><a href="/about.html">About | 关于我</a></li>
            
        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
    <div class='article'>
        <div class="content-title">
            <h1>My test</h1>
Mon 10 April 2017

by <a class="url fn" href="https://ouyonghao.github.io/author/oyh.html">oyh</a>
 


        </div>
	
        <div><p>To display line numbers, use a path-less shebang instead of colons:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">age</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span>
        <span class="mi">30</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">70</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">box_method</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="nb">file</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    box_method(data, depth = 3, file = None) --&gt; list object</span>

<span class="sd">    Slicing the given data with a customized depth(default value is 3)</span>
<span class="sd">    then replace all age&#39;s value in every sliced boxes with their avg</span>
<span class="sd">    return a list type data</span>

<span class="sd">    （1）此方法为同一权重法（等深分箱），适合分箱后箱内数据较为集中，受离异值</span>
<span class="sd">    影响较小；但对于分布不均匀的数据会加剧数据的波动</span>
<span class="sd">    （2）常见的平滑方法还包括：</span>
<span class="sd">    分箱：使用等宽分箱，分箱后还可以使用边界值或中位数平滑</span>
<span class="sd">    聚类：将特征值相似的数据归集为一群</span>
<span class="sd">    回归：按照合适的函数将噪声值趋近正常</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">box</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="n">depth</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">depth</span><span class="p">:]</span>  <span class="c1">#以给定深度分箱</span>
        <span class="n">box_avg</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">,</span> <span class="n">box</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">box</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="c1">#求均值</span>
        <span class="n">box_smooth</span> <span class="o">=</span> <span class="p">[</span><span class="n">box_avg</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
        <span class="k">if</span>  <span class="nb">file</span><span class="p">:</span>
            <span class="c1">#显示处理前后对比</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;{} --&gt; {:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">box</span><span class="p">),</span> <span class="n">box_avg</span><span class="p">),</span> <span class="nb">file</span> <span class="o">=</span> <span class="nb">file</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;{} --&gt; {:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">box</span><span class="p">),</span> <span class="n">box_avg</span><span class="p">),</span> <span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">box_smooth</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>结果显示为：</p>
<div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">分析答案(output)：</span>

<span class="sd">[13, 15, 16] --&gt; 14.67</span>
<span class="sd">[16, 19, 20] --&gt; 18.33</span>
<span class="sd">[20, 21, 22] --&gt; 21.00</span>
<span class="sd">[22, 25, 25] --&gt; 24.00</span>
<span class="sd">[25, 25, 30] --&gt; 26.67</span>
<span class="sd">[33, 33, 33] --&gt; 33.00</span>
<span class="sd">[35, 35, 35] --&gt; 35.00</span>
<span class="sd">[35, 36, 40] --&gt; 37.00</span>
<span class="sd">[45, 46, 52] --&gt; 47.67</span>
<span class="sd">[70] --&gt; 70.00</span>

<span class="sd">1）分箱平滑:</span>
<span class="sd">[14.67, 14.67, 14.67, 18.33, 18.33, 18.33, 21.0, 21.0, 21.0, </span>
<span class="sd">24.0, 24.0, 24.0, 26.67, 26.67, 26.67, 33.0, 33.0, 33.0, 35.0, 35.0, 35.0, </span>
<span class="sd">37.0, 37.0, 37.0, 47.67, 47.67, 47.67, 70.0]</span>

<span class="sd">&quot;&quot;&quot;</span>
</pre></div>


<p><a href="https://ouyonghao.github.io/2017Apr/downloads/test.py">Read more | 阅读全文</a></p></div>
	
        <hr>

    </div>
        </div>
        
        <div class="span3">
            
			<div class="well" style="padding: 14px 0; background-color: #FBFBFB;">
			<ul class="nav nav-list">
				<li class="nav-header">
				Author: 碎琼乱玉
				</li>
				
				<li>
				<a href = "https://ouyonghao.github.io/about.html">
                 <img src="https://ouyonghao.github.io/images/my_head.png" width="80" height="80" align="middle" alt="头像" />
				</li>
			</ul>
            </div>
			
			
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Site|导航
                </li>
            
                <li><a href="https://ouyonghao.github.io/archives.html">Archives|归档</a>
                <li><a href="https://ouyonghao.github.io/tags.html">Tags|标签</a>




            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categories|分类
                </li>
                
                <li><a href="https://ouyonghao.github.io/pelican/index.html">pelican</a></li>
                   
            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Contact me| 
                </li>
            
                <li><a href="http://weibo.com/oyhowen823" target="view_window">Weibo|微博</a></li>
                <li><a href="http://www.scholat.com/ouyh" target="view_window">Scholat|学者网</a></li>
                <li><a href="http://space.bilibili.com/21354645/" target="view_window">Bilibili|B站</a></li>
            </ul>
            </div>


            <div class="social">
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Social|社会
                </li>
           
                <li><a href="http://www.gdufs.edu.cn" target="view_)windows">GDUFS</a></li>
                <li><a href="http://python.org/" target="view_)windows">Python.org</a></li>
            </ul>
            </div>
            </div>

        </div>  
    </div>     </div> 
<footer>
<br />
<p>
<a href="https://ouyonghao.github.io">碎琼乱玉</a> &copy; oyh 2017-04-10
powered by <a href="https://blog.getpelican.com/" target="view_windows">pelican</a>
</p>
</footer>

</div> <!-- /container -->


<script src="https://ouyonghao.github.io/theme/bootstrap-collapse.js"></script>
<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
 
</body>
</html>